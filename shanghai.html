<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸Šæµ·å››å¤©ä¸‰å¤œï¼å†¬æ—¥è–èª•ç¶ºå¤¢ (å°ä¸­å‡ºç™¼)</title>
    <style>
        body {
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
            background-color: #fdf6e3;
            color: #444;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 { color: #d35400; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); margin-bottom: 10px; text-align: center; }
        
        /* Header Container for Collapsible Sections */
        .header-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #b2ebf2;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .header-row h2 {
            color: #00838f;
            margin: 0;
            border-bottom: none;
            padding-bottom: 0;
        }
        .btn-fold {
            background-color: #e0f7fa;
            border: 1px solid #00acc1;
            color: #006064;
            border-radius: 20px;
            padding: 5px 15px;
            font-size: 0.9em;
            cursor: pointer;
            transition: 0.3s;
        }
        .btn-fold:hover {
            background-color: #b2ebf2;
        }

        .container {
            max-width: 900px;
            width: 100%;
            background: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }

        /* Map Controls */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .btn-toggle {
            padding: 8px 20px;
            border: 2px solid transparent;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            font-size: 15px;
            transition: 0.3s;
            background-color: #eee;
            color: #555;
        }

        .btn-toggle.active-d2 { background-color: #ffccbc; color: #bf360c; border-color: #ff5722; }
        .btn-toggle.active-d3 { background-color: #e1bee7; color: #7b1fa2; border-color: #9c27b0; }
        .btn-toggle.active-all { background-color: #b2dfdb; color: #00695c; border-color: #009688; }
        
        #mapCanvas {
            width: 100%;
            border-radius: 15px;
            border: 2px solid #eee;
            background-color: #fffbf0;
            cursor: pointer;
        }

        /* Schedule Tables */
        .day-badge {
            display: inline-block;
            padding: 8px 15px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            margin-top: 25px;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        .bg-d1 { background-color: #78909c; } 
        .bg-d2 { background-color: #ff7043; } 
        .bg-d3 { background-color: #ab47bc; } 
        .bg-d4 { background-color: #5c6bc0; } 

        table { width: 100%; border-collapse: collapse; font-size: 0.95em; margin-bottom: 10px; }
        th, td { padding: 12px 15px; border-bottom: 1px solid #eee; text-align: left; }
        th { background-color: #fafafa; color: #555; width: 22%; font-weight: bold; }
        tr:hover { background-color: #fce4ec; }
        
        .transport { color: #1565c0; font-weight: bold; font-size: 0.9em; }
        .tw-leg { color: #2e7d32; font-weight: bold; }

        /* Info Grid (Attractions & Notes) */
        .grid-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .card {
            background-color: #fdfdfd;
            border: 1px solid #eee;
            border-radius: 10px;
            padding: 15px;
            border-left: 5px solid #ccc;
        }
        
        .card-attr { border-left-color: #00bcd4; }
        .card-hotel { border-left-color: #e91e63; background-color: #fff0f5; }
        .card-note { border-left-color: #ffb74d; }
        
        .card h4 { margin-top: 0; margin-bottom: 10px; color: #333; display: flex; align-items: center; justify-content: space-between; }
        .card p { margin: 5px 0; font-size: 0.9em; color: #666; line-height: 1.5; }

        /* Reviews Section Style */
        .review-card {
            background-color: #f1f8e9;
            border-left: 5px solid #8bc34a;
        }
        .review-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .user-icon {
            width: 30px;
            height: 30px;
            background-color: #c5e1a5;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-size: 16px;
        }
        .stars { color: #fbc02d; margin-left: auto; font-size: 0.9em; }

        /* Photo Spots Style */
        .photo-card {
            background: white;
            border: 1px solid #eee;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            transition: transform 0.2s;
        }
        .photo-card:hover {
            transform: translateY(-5px);
        }
        .photo-img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            background-color: #eee;
        }
        .photo-info {
            padding: 15px;
        }
        .photo-tag {
            display: inline-block;
            background-color: #e3f2fd;
            color: #1976d2;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            margin-bottom: 8px;
            font-weight: bold;
        }
        .photo-detail-row {
            font-size: 0.85em;
            color: #666;
            margin-bottom: 6px;
            display: flex;
            align-items: baseline;
        }
        .photo-detail-row i {
            margin-right: 6px;
            width: 16px;
        }
        .photo-tips {
            background-color: #fff8e1;
            padding: 8px;
            border-radius: 6px;
            font-size: 0.85em;
            color: #f57f17;
            margin-top: 10px;
        }
        
        /* Story Section */
        .story-section {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            padding: 40px;
            text-align: center;
            border-radius: 20px;
            margin-top: 20px;
        }
        .story-text {
            font-family: "Georgia", "Times New Roman", serif;
            font-style: italic;
            color: #5d4037;
            font-size: 1.1em;
            line-height: 1.8;
            max-width: 700px;
            margin: 0 auto;
        }
        .story-title {
            font-size: 1.5em;
            color: #d84315;
            margin-bottom: 20px;
            font-weight: bold;
        }

        /* Toggle Visibility Helper */
        .collapsed {
            display: none !important;
        }

    </style>
</head>
<body>

    <h1>â„ï¸ 2025 ä¸Šæµ·ï¼å†¬æ—¥è–èª•ç¶ºå¤¢</h1>
    <div style="text-align: center; color: #666; margin-bottom: 20px;">
        Taipei âœˆï¸ Shanghai<br>
        2025.12.25 - 2025.12.28
    </div>

    <!-- 1. åœ°åœ–å€å¡Š -->
    <div class="container">
        <div class="header-row">
            <h2>ğŸ—ºï¸ æ¯æ—¥è·¯ç·š</h2>
        </div>
        <div class="controls">
            <button class="btn-toggle active-d2" onclick="toggleMap('day2')" id="btnDay2">Day 2 (å¤–ç˜ç¶“å…¸)</button>
            <button class="btn-toggle" onclick="toggleMap('day3')" id="btnDay3">Day 3 (æ–‡è—é›œæŠ€)</button>
            <button class="btn-toggle" onclick="toggleMap('all')" id="btnAll">é¡¯ç¤ºå…¨éƒ¨</button>
        </div>
        <canvas id="mapCanvas" width="850" height="1100"></canvas>
    </div>

    <!-- 2. è¡Œç¨‹å€å¡Š -->
    <div class="container">
        <div class="header-row">
            <h2>ğŸ“… è¡Œç¨‹æ™‚é–“è¡¨</h2>
            <button class="btn-fold" onclick="toggleSection('scheduleContent', this)">æ”¶åˆ â–²</button>
        </div>
        
        <div id="scheduleContent">
            <div class="day-badge bg-d1">Day 1ï¼š12/25 (å››) å•Ÿç¨‹èˆ‡è–èª•å¤œ</div>
            <table>
                <tr><th class="tw-leg">11:00 - 13:30</th><td class="tw-leg"><span class="transport">ğŸš™ åŒ…è»Š</span> å°ä¸­çš‡åŸå¸å¯¶ â” æ¡ƒåœ’æ©Ÿå ´ T2</td></tr>
                <tr><th>13:30 - 16:35</th><td>ğŸ›‚ æ©Ÿå ´å ±åˆ°ã€è¡Œææ‰˜é‹ã€åˆé¤</td></tr>
                <tr><th>16:35 - 18:35</th><td>âœˆï¸ è¯èˆª CI503 (TPE â” PVG T1)</td></tr>
                <tr><th>19:30 - 20:30</th><td><span class="transport">ğŸš— è¨ˆç¨‹è»Š</span> å‰å¾€é£¯åº— (ç´„60åˆ†)</td></tr>
                <tr><th>20:30</th><td>ğŸ¨ å…¥ä½ï¼šå¦‚å®¶ç²¾é¸ (é™¸å®¶å˜´å•†åŸè·¯åº—)</td></tr>
                <tr><th>21:00</th><td>ğŸœ æ™šé¤ï¼šå¤–è³£æˆ–é™„è¿‘å•†å ´è¦“é£Ÿ (è–èª•å¿«æ¨‚!)</td></tr>
            </table>

            <div class="day-badge bg-d2">Day 2ï¼š12/26 (äº”) ç¹èŠ±ä¸Šæµ· & ä¿„å¼é¢¨æƒ…</div>
            <table>
                <tr><th>10:00 - 10:25</th><td><span class="transport">ğŸš— è¨ˆç¨‹è»Š</span> é£¯åº— â” åŸéšå»Ÿ</td></tr>
                <tr><th>10:25 - 12:15</th><td>ğŸ“ <b>åŸéšå»Ÿ + è±«åœ’</b> (åˆé¤ï¼šç¶ æ³¢å»Š)</td></tr>
                <tr><th>12:15 - 12:40</th><td><span class="transport">ğŸš— è¨ˆç¨‹è»Š</span> ç§»å‹• (å‰å¾€è™¹å£å€)</td></tr>
                <tr><th>12:40 - 13:40</th><td>ğŸ“ <b>ä¿„ç¾…æ–¯å‡ºå£ä¸­å¿ƒ (ä¿„ç¾…æ–¯é¤¨)</b> è™¹å£åº—</td></tr>
                <tr><th>13:40 - 14:00</th><td><span class="transport">ğŸš— è¨ˆç¨‹è»Š</span> ç§»å‹• (å‰å¾€å—äº¬æ­¥è¡Œè¡—)</td></tr>
                <tr><th>14:00 - 15:15</th><td>ğŸ“ <b>å—äº¬æ­¥è¡Œè¡—</b> (æ­å°ç«è»Š/é€›M&M/æ¨‚é«˜åº—)</td></tr>
                <tr><th>15:15 - 15:30</th><td><span class="transport">ğŸš¶ æ­¥è¡Œ</span> å¾€æ±èµ°åˆ°å¤–ç˜</td></tr>
                <tr><th>15:30 - 17:00</th><td>ğŸ“ <b>å¤–ç˜è¬åœ‹å»ºç¯‰ç¾¤</b> (å’Œå¹³é£¯åº—ã€æ—¥è½)</td></tr>
                <tr><th>17:00 - 17:30</th><td><span class="transport">â›´ï¸ æ¸¡è¼ª/è¨ˆç¨‹è»Š</span> éæ±Ÿ â” é™¸å®¶å˜´</td></tr>
                <tr><th>17:30 - 18:45</th><td>ğŸ“ <b>æ±æ–¹æ˜ç </b> (å¡”ä¸‹æ‹ç…§/åƒè§€)</td></tr>
                <tr><th>18:45 - 19:00</th><td><span class="transport">ğŸš¶ æ­¥è¡Œ</span> å¤©æ©‹æ¼«æ­¥</td></tr>
                <tr><th>19:00 - 20:30</th><td>ğŸ“ <b>é™¸å®¶å˜´ä¸‰ä»¶å¥—</b> + æ™šé¤ (æ­£å¤§å»£å ´/åœ‹é‡‘ä¸­å¿ƒ)</td></tr>
                <tr><th>20:30 - 22:00</th><td>ğŸ’† <b>æŒ‰æ‘©æ”¾é¬†</b> (æ¨è–¦ï¼šå¤§æ¡¶å¤§/åº·é§¿)</td></tr>
                <tr><th>22:00 - 22:20</th><td>ğŸ¨ <b>è¿”å›é£¯åº—ä¼‘æ¯</b></td></tr>
            </table>

            <div class="day-badge bg-d3">Day 3ï¼š12/27 (å…­) æ™‚ç©ºäº¤éŒ¯</div>
            <table>
                <tr><th>10:00 - 10:30</th><td><span class="transport">ğŸš™ åŒ…è»Š</span> é£¯åº— â” å¾å®¶åŒ¯</td></tr>
                <tr><th>10:30 - 11:15</th><td>ğŸ“ <b>å¾å®¶åŒ¯ (ç¾ç¾…åŸ)</b> (åœç•™45åˆ†)</td></tr>
                <tr><th>11:15 - 11:30</th><td><span class="transport">ğŸš™ åŒ…è»Š</span> ç§»å‹•</td></tr>
                <tr><th>11:30 - 13:00</th><td>ğŸ“ <b>æ­¦åº·è·¯</b> (æ­¦åº·å¤§æ¨“æ‹ç…§) + åˆé¤</td></tr>
                <tr><th>13:00 - 13:20</th><td><span class="transport">ğŸš™ åŒ…è»Š</span> ç§»å‹•</td></tr>
                <tr><th>13:20 - 14:20</th><td>ğŸ“ <b>éœå®‰å¯º</b> + è²·ä¼´æ‰‹ç¦®(å“ˆçˆ¾æ¿±é£Ÿå“å» )</td></tr>
                <tr><th>14:20 - 14:30</th><td><span class="transport">ğŸš™ åŒ…è»Š</span> ç§»å‹•</td></tr>
                <tr><th>14:30 - 15:15</th><td>ğŸ“ <b>å¼µåœ’</b> (çŸ³åº«é–€æ™‚å°šè¡—å€)</td></tr>
                <tr><th>15:15 - 15:30</th><td><span class="transport">ğŸš¶ æ­¥è¡Œ/è»Š</span> ç§»å‹• (å…©åœ°è·é›¢å¾ˆè¿‘)</td></tr>
                <tr><th>15:30 - 16:15</th><td>ğŸ“ <b>LVè·¯æ˜“è™Ÿ</b> (æ‹ç…§æ‰“å¡)</td></tr>
                <tr><th>16:15 - 16:40</th><td><span class="transport">ğŸš™ åŒ…è»Š</span> ç§»å‹•</td></tr>
                <tr><th>16:40 - 18:30</th><td>ğŸ“ <b>å¤©å®‰åƒæ¨¹</b> + æ™šé¤ï¼šæ¼å“¥Â·æ¹›æ±Ÿ (å»ºè­°17:00ç”¨é¤)</td></tr>
                <tr><th>18:30 - 18:50</th><td><span class="transport">ğŸš™ åŒ…è»Š</span> ç§»å‹•å‰å¾€é¦¬æˆ²åŸ</td></tr>
                <tr><th>19:00 - 20:40</th><td>ğŸª <b>æ™‚ç©ºä¹‹æ—… 2</b> @ä¸Šæµ·é¦¬æˆ²åŸ (éœ‡æ’¼é›œæŠ€)</td></tr>
                <tr><th>20:40 - 21:20</th><td>ğŸ¨ <b>è¿”å›é£¯åº—ä¼‘æ¯</b></td></tr>
            </table>

            <div class="day-badge bg-d4">Day 4ï¼š12/28 (æ—¥) æ­¸é€”</div>
            <table>
                <tr><th>08:45 - 09:45</th><td><span class="transport">ğŸš— è¨ˆç¨‹è»Š</span> é£¯åº— â” æµ¦æ±æ©Ÿå ´ T1</td></tr>
                <tr><th>10:00 - 12:05</th><td>ğŸ›ï¸ å ±åˆ°ã€å‡ºå¢ƒå®‰æª¢ã€å…ç¨…åº—æ¡è³¼</td></tr>
                <tr><th>12:05 - 14:15</th><td>âœˆï¸ è¯èˆª CI504 (PVG T1 â” TPE T2)</td></tr>
                <tr><th>14:15 - 15:00</th><td>ğŸ›‚ é ˜å–è¡Œæã€å…¥å¢ƒ</td></tr>
                <tr><th class="tw-leg">15:00 - 17:30</th><td class="tw-leg"><span class="transport">ğŸš™ åŒ…è»Š</span> æ¡ƒåœ’æ©Ÿå ´ T2 â” å°ä¸­çš‡åŸå¸å¯¶</td></tr>
            </table>
        </div>
    </div>

    <!-- 3. æ™¯é»è³‡è¨Š (å¯æŠ˜ç–Š) -->
    <div class="container">
        <div class="header-row">
            <h2>â„¹ï¸ æ™¯é»è³‡è¨Š</h2>
            <button class="btn-fold" onclick="toggleSection('attrContent', this)">æ”¶åˆ â–²</button>
        </div>
        
        <div id="attrContent" class="grid-section">
            <div class="card card-hotel">
                <h4>0. ä½å®¿ï¼šå¦‚å®¶ç²¾é¸é…’åº— <span>ğŸ¨</span></h4>
                <p><strong>åœ°å€ï¼š</strong>ä¸Šæµ·, æµ¦æ±æ–°å€, å¼µæ¥Šè·¯579è™Ÿ5å±¤</p>
                <p><strong>äº¤é€šï¼š</strong>åœ°éµ9è™Ÿç·šå•†åŸè·¯ç«™ / 2è™Ÿç·šæ±æ˜Œè·¯ç«™</p>
            </div>
            <div class="card card-attr">
                <h4>1. åŸéšå»Ÿ & è±«åœ’ <span>ğŸ®</span></h4>
                <p><strong>åœ°å€ï¼š</strong>é»ƒæµ¦å€è±«åœ’è€è¡—279è™Ÿ</p>
                <p><strong>æ™‚é–“ï¼š</strong>09:00 - 16:30 (é€±ä¸€é–‰åœ’)</p>
                <p><strong>æ³¨æ„ï¼š</strong>ä¹æ›²æ©‹äººå¤šè«‹æ³¨æ„è²¡ç‰©ï¼›åˆé¤æ¨è–¦ç¶ æ³¢å»Šæˆ–å—ç¿”é¥…é ­åº—ã€‚</p>
            </div>
            <div class="card card-attr">
                <h4>2. ä¿„ç¾…æ–¯å‡ºå£ä¸­å¿ƒ <span>ğŸ°</span></h4>
                <p><strong>åœ°å€ï¼š</strong>è™¹å£å€å››å·åŒ—è·¯989è™Ÿ (ä»Šæ½®8å¼„)</p>
                <p><strong>ç‰¹è‰²ï¼š</strong>ä¿„ç¾…æ–¯åœ‹å®¶é¤¨ï¼Œå¯è³¼è²·æ­£å®—ä¼ç‰¹åŠ ã€å·§å…‹åŠ›ã€èœ‚èœœç­‰ä¼´æ‰‹ç¦®ï¼Œå»ºç¯‰å¯Œæœ‰ç‰¹è‰²ã€‚</p>
            </div>
            <div class="card card-attr">
                <h4>3. å—äº¬æ­¥è¡Œè¡— <span>ğŸ›ï¸</span></h4>
                <p><strong>åœ°å€ï¼š</strong>é»ƒæµ¦å€å—äº¬æ±è·¯</p>
                <p><strong>ç‰¹è‰²ï¼š</strong>ã€Œä¸­è¯å•†æ¥­ç¬¬ä¸€è¡—ã€ï¼Œå¯æ­ä¹˜éºéºè»Š(å°ç«è»Š)éŠè¦½ï¼Œæœ‰è¨±å¤šè€å­—è™Ÿé£Ÿå“åº—èˆ‡ç™¾è²¨ã€‚</p>
            </div>
            <div class="card card-attr">
                <h4>4. å¤–ç˜ (The Bund) <span>ğŸ›ï¸</span></h4>
                <p><strong>åœ°å€ï¼š</strong>é»ƒæµ¦å€ä¸­å±±æ±ä¸€è·¯</p>
                <p><strong>ç‰¹è‰²ï¼š</strong>å¾å—äº¬æ±è·¯èµ°åˆ°åº•å³æŠµé”å¤–ç˜ï¼Œå»ºè­°å¾€å—èµ°åˆ°é‡‘é™µæ±è·¯æ¸¡å£æ­èˆ¹ã€‚</p>
                <p><strong>æ³¨æ„ï¼š</strong>å†¬æ—¥æ±Ÿé‚Šé¢¨å¤§ï¼Œå‹™å¿…æˆ´å¸½å­ä¿æš–ã€‚</p>
            </div>
            <div class="card card-attr">
                <h4>5. æ±æ–¹æ˜ç  <span>ğŸ—¼</span></h4>
                <p><strong>åœ°å€ï¼š</strong>æµ¦æ±æ–°å€ä¸–ç´€å¤§é“1è™Ÿ</p>
                <p><strong>äº®é»ï¼š</strong>ä¸Šæµ·åœ°æ¨™ï¼Œæ¸¡è¼ªä¸‹èˆ¹å¾Œæ­¥è¡Œå¯é”ã€‚è‹¥ä¸ä¸Šå¡”ï¼Œå¯åœ¨å»£å ´æ‹å…¨æ™¯ã€‚</p>
            </div>
            <div class="card card-attr">
                <h4>6. é™¸å®¶å˜´ä¸‰ä»¶å¥— <span>ğŸ™ï¸</span></h4>
                <p><strong>åœ°å€ï¼š</strong>æµ¦æ±æ–°å€æ±æ³°è·¯èˆ‡èŠ±åœ’çŸ³æ©‹è·¯äº¤ç•Œ</p>
                <p><strong>æ‹ç…§ï¼š</strong>ä»°æ‹ä¸Šæµ·ä¸­å¿ƒã€ç’°çƒé‡‘èä¸­å¿ƒã€é‡‘èŒ‚å¤§å»ˆçš„æœ€ä½³ç¶²ç´…è¦–è§’ã€‚</p>
            </div>
            <div class="card card-attr">
                <h4>7. æŒ‰æ‘©æ¨è–¦ (å¤§æ¡¶å¤§/åº·é§¿) <span>ğŸ’†</span></h4>
                <p><strong>åœ°å€ï¼š</strong>æµ¦æ±æ–°å€å•†åŸè·¯é™„è¿‘</p>
                <p><strong>æ™‚é–“ï¼š</strong>é€šå¸¸ç‡Ÿæ¥­è‡³å‡Œæ™¨ 01:00</p>
                <p><strong>å»ºè­°ï¼š</strong>è¡Œç¨‹çµæŸå¾Œæ”¾é¬†ï¼Œå»ºè­°é€éå¤§çœ¾é»è©•AppæŸ¥çœ‹è©•åƒ¹èˆ‡åœ˜è³¼åˆ¸ã€‚</p>
            </div>
            <div class="card card-attr">
                <h4>8. å¾å®¶åŒ¯ (ç¾ç¾…åŸ) <span>ğŸ”®</span></h4>
                <p><strong>åœ°å€ï¼š</strong>å¾åŒ¯å€è‚‡å˜‰æµœè·¯1111è™Ÿ</p>
                <p><strong>ç‰¹è‰²ï¼š</strong>å·¨å‹çƒé«”å»ºç¯‰ã€è£¸çœ¼3Dè¢å¹•ã€æ—¥ç³»å“ç‰Œã€‚</p>
            </div>
            <div class="card card-attr">
                <h4>9. æ­¦åº·è·¯ & æ­¦åº·å¤§æ¨“ <span>ğŸ‚</span></h4>
                <p><strong>åœ°å€ï¼š</strong>å¾åŒ¯å€æ·®æµ·ä¸­è·¯1850è™Ÿ</p>
                <p><strong>æ³¨æ„ï¼š</strong>æ­¦åº·å¤§æ¨“æœ€ä½³æ‹æ”é»åœ¨å°é¢é¦¬è·¯ï¼›è©²å€ç‚ºä½å®…å€è«‹ä¿æŒå®‰éœã€‚</p>
            </div>
            <div class="card card-attr">
                <h4>10. éœå®‰å¯º <span>ğŸ¯</span></h4>
                <p><strong>åœ°å€ï¼š</strong>éœå®‰å€å—äº¬è¥¿è·¯1686è™Ÿ</p>
                <p><strong>ä¼´æ‰‹ç¦®ï¼š</strong>é™„è¿‘æœ‰ã€Œå“ˆçˆ¾æ¿±é£Ÿå“å» ã€ï¼Œå¿…è²·æä»æ’ã€‚</p>
            </div>
            <div class="card card-attr">
                <h4>11. å¼µåœ’ (Zhangyuan) <span>ğŸ§±</span></h4>
                <p><strong>åœ°å€ï¼š</strong>éœå®‰å€å¨æµ·è·¯588å¼„</p>
                <p><strong>ç‰¹è‰²ï¼š</strong>ã€Œæµ·ä¸Šç¬¬ä¸€ååœ’ã€ï¼Œå®Œæ•´ä¿ç•™çš„çŸ³åº«é–€å»ºç¯‰ç¾¤ã€‚</p>
            </div>
            <div class="card card-attr">
                <h4>12. LVè·¯æ˜“è™Ÿ / å“ç‰Œå¿«é–ƒ <span>ğŸ‘œ</span></h4>
                <p><strong>ä½ç½®ï¼š</strong>é€šå¸¸ä½æ–¼å¼µåœ’å…§æˆ–è˜‡å·æ²³ç•” (éœ€ç¢ºèªç•¶å­£æ´»å‹•åœ°é»)</p>
                <p><strong>ç‰¹è‰²ï¼š</strong>LV åœ¨ä¸Šæµ·å¸¸è¨­æœ‰å¤§å‹è£ç½®è—è¡“æˆ–ä¸»é¡Œå±•è¦½ï¼Œæ‰“å¡ç†±é»ã€‚</p>
            </div>
            <div class="card card-attr">
                <h4>13. å¤©å®‰åƒæ¨¹ & æ¼å“¥Â·æ¹›æ±Ÿ <span>ğŸŒ³</span></h4>
                <p><strong>åœ°å€ï¼š</strong>æ™®é™€å€è«å¹²å±±è·¯600è™Ÿ</p>
                <p><strong>æ™šé¤ï¼š</strong>æ¼å“¥Â·æ¹›æ±Ÿ (L4å±¤)ï¼Œä¸»æ‰“ç™½åˆ‡é›èˆ‡æµ·é®®ï¼Œå»ºè­°æå‰è¨‚ä½ã€‚</p>
            </div>
            <div class="card card-attr">
                <h4>14. æ™‚ç©ºä¹‹æ—…2 (ERA 2) <span>ğŸª</span></h4>
                <p><strong>åœ°å€ï¼š</strong>éœå®‰å€å…±å’Œæ–°è·¯2266è™Ÿ (ä¸Šæµ·é¦¬æˆ²åŸ)</p>
                <p><strong>æ™‚é–“ï¼š</strong>19:00 - 20:40 (å«ä¸­å ´ä¼‘æ¯)</p>
                <p><strong>æ³¨æ„ï¼š</strong>è«‹å‹™å¿…æå‰ç¶²è·¯è³¼ç¥¨ï¼›é²åˆ°éœ€ç­‰å¾…ä¸­å ´æ‰èƒ½é€²å…¥ã€‚</p>
            </div>
        </div>
    </div>

    <!-- 4. æ³¨æ„äº‹é … (å¯æŠ˜ç–Š) -->
    <div class="container">
        <div class="header-row">
            <h2>ğŸ“ æ—…éŠå°å®åš€</h2>
            <button class="btn-fold" onclick="toggleSection('noteContent', this)">æ”¶åˆ â–²</button>
        </div>

        <div id="noteContent" class="grid-section">
            <div class="card card-note">
                <h4>ğŸ’ å¿…å‚™æ¸…å–®</h4>
                <p><strong>è­‰ä»¶ï¼š</strong>å°èƒè­‰ (ç¢ºèªæ•ˆæœŸ)ã€è­·ç…§ã€‚</p>
                <p><strong>æ•¸ä½ï¼š</strong>ç¶²å¡ (å…ç¿»ç‰†)ã€è¡Œå‹•é›»æºã€‚</p>
                <p><strong>Appï¼š</strong>æ”¯ä»˜å¯¶ (ç¶å°å¡)ã€å¾®ä¿¡ã€é«˜å¾·åœ°åœ–ã€‚</p>
            </div>
            <div class="card card-note">
                <h4>â„ï¸ æ°£å€™èˆ‡ç©¿è‘—</h4>
                <p><strong>æ°£æº«ï¼š</strong>12æœˆåº•ä¸Šæµ·æ¿•å†· (2-8Â°C)ã€‚</p>
                <p><strong>ç©¿æ­ï¼š</strong>ç¾½çµ¨è¡£ã€åœå·¾ã€æ‰‹å¥—ã€å¥½èµ°çš„é‹ã€‚</p>
                <p><strong>æé†’ï¼š</strong>å®¤å…§æš–æ°£å¼·ï¼Œå»ºè­°æ´‹è”¥å¼ç©¿æ³•ã€‚</p>
            </div>
            <div class="card card-note">
                <h4>ğŸ ä¼´æ‰‹ç¦®</h4>
                <p><strong>å“ˆçˆ¾æ¿±é£Ÿå“å» ï¼š</strong>æä»æ’ã€è¥¿ç•ªå°¼ã€‚</p>
                <p><strong>å…¶ä»–ï¼š</strong>å¤§ç™½å…”å¥¶ç³–ã€é›ªèŠ±è†ã€‚</p>
                <p><strong>ä½ç½®ï¼š</strong>éœå®‰å¯ºã€æ·®æµ·ä¸­è·¯çš†æœ‰åˆ†åº—ã€‚</p>
            </div>
        </div>
    </div>

    <!-- 5. æ—…éŠè©•é‘‘ -->
    <div class="container">
        <div class="header-row">
            <h2>â­ æ—…éŠè©•é‘‘</h2>
            <button class="btn-fold" onclick="toggleSection('reviewContent', this)">æ”¶åˆ â–²</button>
        </div>
        <div id="reviewContent" class="grid-section">
            
            <div class="card review-card">
                <div class="review-header">
                    <div class="user-icon">ğŸ“¸</div>
                    <strong>æ”å½±ç‹‚é­”</strong>
                    <div class="stars">â˜…â˜…â˜…â˜…â˜…</div>
                </div>
                <h4>æ‹ç…§æ¨è–¦ï¼šåŒ—å¤–ç˜</h4>
                <p>å¦‚æœæƒ³æ‹è¬åœ‹å»ºç¯‰èˆ‡é™¸å®¶å˜´å…¨æ™¯ï¼Œå¼·çƒˆå»ºè­°å»ã€ŒåŒ—å¤–ç˜ã€ï¼é‚£è£¡äººæ¯”å¤–ç˜ä¸»å€å°‘å¾ˆå¤šï¼Œè¦–è§’æ›´é–‹é—Šï¼Œèƒ½è¼•é¬†æ‹å‡ºç„¡äººæ“‹é¡é ­çš„å¤§ç‰‡ã€‚</p>
            </div>

            <div class="card review-card">
                <div class="review-header">
                    <div class="user-icon">ğŸ”</div>
                    <strong>å··å¼„æ¢éšªå®¶</strong>
                    <div class="stars">â˜…â˜…â˜…â˜…â˜†</div>
                </div>
                <h4>ç§æˆ¿æ™¯é»ï¼šå¼µåœ’ & ä¿„ç¾…æ–¯é¤¨</h4>
                <p>å¼µåœ’çš„çŸ³åº«é–€å»ºç¯‰ä¿®å¾©å¾—éå¸¸ç¾ï¼Œç´°ç¯€æ»¿æ»¿ï¼›è™¹å£çš„ä¿„ç¾…æ–¯å‡ºå£ä¸­å¿ƒå¾ˆæœ‰ç•°åœ‹æƒ…èª¿ï¼Œä¸åƒå—äº¬è·¯é‚£éº¼æ“æ“ ï¼Œå€¼å¾—èŠ±æ™‚é–“æ…¢æ…¢é€›ã€‚</p>
            </div>

            <div class="card review-card">
                <div class="review-header">
                    <div class="user-icon">ğŸ½ï¸</div>
                    <strong>åƒè²¨å°éšŠé•·</strong>
                    <div class="stars">â˜…â˜…â˜…â˜…â˜…</div>
                </div>
                <h4>é¤é»æ¨è–¦ï¼šæ¼å“¥Â·æ¹›æ±Ÿ</h4>
                <p>å¤©å®‰åƒæ¨¹è£¡çš„ã€Œæ¼å“¥Â·æ¹›æ±Ÿã€ï¼Œç™½åˆ‡é›çœŸçš„çµ•ï¼é›çš®çˆ½è„†è‚‰è³ªå«©æ»‘ï¼Œæµ·é®®ä¹Ÿå¾ˆæ–°é®®ï¼ŒCPå€¼è¶…é«˜ï¼Œçµ•å°æ˜¯å¥½åƒä¸è¸©é›·çš„é¸æ“‡ã€‚</p>
            </div>

            <div class="card review-card">
                <div class="review-header">
                    <div class="user-icon">ğŸ›ï¸</div>
                    <strong>ä¼´æ‰‹ç¦®é”äºº</strong>
                    <div class="stars">â˜…â˜…â˜…â˜…â˜…</div>
                </div>
                <h4>å¿…è²·æ¨è–¦ï¼šå“ˆçˆ¾æ¿±é£Ÿå“å» </h4>
                <p>æä»æ’çµ•å°æ˜¯å¿…è²·ï¼å¸¶å›å»è¾¦å…¬å®¤åˆ†é€åŒäº‹ç§’æ®ºã€‚å¦å¤–å¤§ç™½å…”çš„è¯åå•†å“åŒ…è£å¾ˆå¯æ„›ï¼Œé€ç¦®éå¸¸æœ‰é¢å­ã€‚</p>
            </div>

        </div>
    </div>

    <!-- 6. æ‹ç…§æ™¯é» (New - Fixed Links) -->
    <div class="container">
        <div class="header-row">
            <h2>ğŸ“¸ æ‹ç…§æ™¯é»</h2>
            <button class="btn-fold" onclick="toggleSection('photoContent', this)">æ”¶åˆ â–²</button>
        </div>
        <div id="photoContent" class="grid-section">
            
            <!-- Card 1: The Bund -->
            <div class="photo-card">
                <img src="https://ak-d.tripcdn.com/images/10040m000000dht6p0F19_C_1200_800_Q70.webp?proc=source%2ftrip" class="photo-img" alt="å¤–ç˜å¤œæ™¯">
                <div class="photo-info">
                    <span class="photo-tag">å¤œæ™¯</span> <span class="photo-tag">åœ°æ¨™</span>
                    <h4>å¤–ç˜è¬åœ‹å»ºç¯‰ç¾¤</h4>
                    <div class="photo-detail-row">ğŸ“ <strong>åœ°é»ï¼š</strong>é‡‘é™µæ±è·¯æ¸¡å£é™„è¿‘</div>
                    <div class="photo-detail-row">ğŸ“ <strong>è§’åº¦ï¼š</strong>ä½è§’åº¦ä»°æ‹æˆ–å€šé æ±Ÿé‚Šæ¬„æ†</div>
                    <div class="photo-tips">
                        ğŸ’¡ <strong>åƒæ•¸ï¼š</strong>å…‰åœˆ f/2.8 ä»¥ä¸Šï¼Œå¤œé–“å»ºè­°ä½¿ç”¨è…³æ¶æˆ–æ‰‹æŒå¤œæ™¯æ¨¡å¼ï¼Œæ›å…‰ 1-2ç§’ã€‚
                    </div>
                </div>
            </div>

            <!-- Card 2: Wukang Mansion -->
            <div class="photo-card">
                <img src="https://imgs.699pic.com/images/500/634/714.jpg!detail.v1" class="photo-img" alt="æ­¦åº·å¤§æ¨“">
                <div class="photo-info">
                    <span class="photo-tag">å»ºç¯‰</span> <span class="photo-tag">ç¶²ç´…</span>
                    <h4>æ­¦åº·å¤§æ¨“ (è«¾æ›¼ç¬¬å…¬å¯“)</h4>
                    <div class="photo-detail-row">ğŸ“ <strong>åœ°é»ï¼š</strong>æ·®æµ·ä¸­è·¯/æ­¦åº·è·¯è·¯å£å°é¢</div>
                    <div class="photo-detail-row">ğŸ“ <strong>è§’åº¦ï¼š</strong>å»£è§’é¡é ­æ‹æ”å¤§æ¨“èˆ¹å‹å…¨è²Œ</div>
                    <div class="photo-tips">
                        ğŸ’¡ <strong>åƒæ•¸ï¼š</strong>ç™½å¤©å…‰ç·šå……è¶³ï¼ŒISO 100ï¼Œä½¿ç”¨äººåƒæ¨¡å¼è™›åŒ–èƒŒæ™¯é›œäº‚äººç¾¤ã€‚
                    </div>
                </div>
            </div>

            <!-- Card 3: Yu Garden -->
            <div class="photo-card">
                <img src="https://ak-d.tripcdn.com/images/1mi4o224x8uh5pubn5636_W_640_0_R5_Q80.jpg?proc=source/trip" class="photo-img" alt="è±«åœ’">
                <div class="photo-info">
                    <span class="photo-tag">å¤å…¸</span> <span class="photo-tag">äººåƒ</span>
                    <h4>è±«åœ’ / ä¹æ›²æ©‹</h4>
                    <div class="photo-detail-row">ğŸ“ <strong>åœ°é»ï¼š</strong>ä¹æ›²æ©‹ä¸­å¿ƒæˆ–æ¹–å¿ƒäº­æ—</div>
                    <div class="photo-detail-row">ğŸ“ <strong>è§’åº¦ï¼š</strong>åˆ©ç”¨é£›ç°·ç¿¹è§’ä½œç‚ºå‰æ™¯æ¡†æ¶</div>
                    <div class="photo-tips">
                        ğŸ’¡ <strong>èªªæ˜ï¼š</strong>å»ºè­°é¿é–‹æ­£åˆé ‚å…‰ï¼Œä¸‹åˆ3-4é»å…‰ç·šæŸ”å’Œï¼Œé©åˆæ‹å¤è£æˆ–æ¼¢æœäººåƒã€‚
                    </div>
                </div>
            </div>

            <!-- Card 4: Lujiazui -->
            <div class="photo-card">
                <img src="https://images.unsplash.com/photo-1474181487882-5abf3f0ba6c2?auto=format&fit=crop&w=600&q=80" class="photo-img" alt="é™¸å®¶å˜´ä¸‰ä»¶å¥—">
                <div class="photo-info">
                    <span class="photo-tag">é­”å¹»</span> <span class="photo-tag">å»£è§’</span>
                    <h4>é™¸å®¶å˜´ä¸‰ä»¶å¥—</h4>
                    <div class="photo-detail-row">ğŸ“ <strong>åœ°é»ï¼š</strong>æ±æ³°è·¯èˆ‡èŠ±åœ’çŸ³æ©‹è·¯è·¯å£</div>
                    <div class="photo-detail-row">ğŸ“ <strong>è§’åº¦ï¼š</strong>æ‰‹æ©Ÿè²¼è¿‘åœ°é¢è¶…å»£è§’ä»°æ‹</div>
                    <div class="photo-tips">
                        ğŸ’¡ <strong>æŠ€å·§ï¼š</strong>é–‹å•Ÿæ ¼ç·šæ§‹åœ–ï¼Œè®“ä¸‰æ£Ÿå¤§æ¨“å½¢æˆä¸‰è§’å½¢å¹¾ä½•æ§‹åœ–ï¼Œæ¥µå…·è¦–è¦ºè¡æ“ŠåŠ›ã€‚
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- 7. æ—…ç¨‹æ•…äº‹ -->
    <div class="container story-section">
        <div class="story-title">ğŸ“– é—œæ–¼é€™è¶Ÿæ—…ç¨‹</div>
        <div class="story-text">
            <p>
                é€™ä¸åƒ…åƒ…æ˜¯ä¸€æ¬¡æ—…è¡Œï¼Œè€Œæ˜¯ä¸€å ´ç©¿è¶Šæ™‚ç©ºçš„å°è©±ã€‚<br>
                å¾ 1930 å¹´ä»£çš„åé‡Œæ´‹å ´ï¼Œåˆ° 2025 å¹´çš„æ‘©ç™»å¤©éš›ç·šï¼Œä¸Šæµ·å°‡ä»¥å®ƒç¨æœ‰çš„æº«åº¦æ“æŠ±ä½ ã€‚
            </p>
            <p>
                åœ¨ <b>12æœˆ25æ—¥</b> é€™å€‹ç‰¹åˆ¥çš„æ—¥å­å‡ºç™¼ï¼Œ<br>
                å¾å°ä¸­çš„å®¶é–€ï¼Œä¸€è·¯é£›å‘é»ƒæµ¦æ±Ÿç•”çš„ç‡ˆç«è¼ç…Œã€‚<br>
                ä½ å€‘å°‡åœ¨æ¢§æ¡æ¨¹ä¸‹çš„æ­¦åº·è·¯è½è¦‹æ­·å²çš„ä½èªï¼Œ<br>
                åœ¨é™¸å®¶å˜´çš„é›²ç«¯çœ‹è¦‹æœªä¾†çš„æ¨¡æ¨£ã€‚
            </p>
            <p>
                é¡˜å¤–ç˜çš„é¢¨ï¼Œå¹èµ°æ•´å¹´çš„ç–²æ†Šï¼›<br>
                é¡˜åŸéšå»Ÿçš„ç‡ˆï¼Œç…§äº®æ–°å¹´çš„æœŸç›¼ã€‚<br>
                é€™å››å¤©ä¸‰å¤œï¼Œä¸æ±‚èµ°éæ¯ä¸€æ¢è¡—ï¼Œåªæ±‚åœ¨æ¯ä¸€å€‹è½‰è§’ï¼Œ<br>
                éƒ½ç•™ä¸‹å±¬æ–¼ä½ å€‘ï¼Œæœ€æº«æš–çš„å†¬æ—¥è¨˜æ†¶ã€‚
            </p>
            <p style="margin-top: 30px; font-size: 0.9em; color: #d84315;">â€”â€” ç¥ æ—…é€”æ„‰å¿« Bon Voyage â€”â€”</p>
        </div>
    </div>

    <script>
        // è¨­å®šç›®å‰çš„é¡¯ç¤ºç‹€æ…‹
        let mapState = { day2: true, day3: false };

        window.onload = function() {
            drawMap();
            updateButtons();
        };

        function toggleMap(type) {
            if (type === 'day2') {
                mapState.day2 = true; mapState.day3 = false;
            } else if (type === 'day3') {
                mapState.day2 = false; mapState.day3 = true;
            } else if (type === 'all') {
                mapState.day2 = true; mapState.day3 = true;
            }
            updateButtons();
            drawMap();
        }

        function updateButtons() {
            document.getElementById('btnDay2').className = 'btn-toggle';
            document.getElementById('btnDay3').className = 'btn-toggle';
            document.getElementById('btnAll').className = 'btn-toggle';

            if (mapState.day2 && !mapState.day3) {
                document.getElementById('btnDay2').classList.add('active-d2');
            } else if (!mapState.day2 && mapState.day3) {
                document.getElementById('btnDay3').classList.add('active-d3');
            } else {
                document.getElementById('btnAll').classList.add('active-all');
            }
        }

        // æ‘ºç–ŠåŠŸèƒ½ Function
        function toggleSection(id, btn) {
            var content = document.getElementById(id);
            if (content.style.display === "none") {
                if (id === 'scheduleContent') content.style.display = "block";
                else content.style.display = "grid"; 
                btn.innerHTML = "æ”¶åˆ â–²";
            } else {
                content.style.display = "none";
                btn.innerHTML = "å±•é–‹ â–¼";
            }
        }

        function drawMap() {
            const canvas = document.getElementById('mapCanvas');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            ctx.clearRect(0, 0, width, height);
            ctx.fillStyle = "#fffbf0"; 
            ctx.fillRect(0, 0, width, height);

            // é»ƒæµ¦æ±Ÿ
            ctx.beginPath();
            ctx.moveTo(width/2 + 20, height); 
            ctx.bezierCurveTo(width/2 - 50, height - 300, width/2 + 250, height - 600, width/2 + 20, 0);
            ctx.lineWidth = 60;
            ctx.strokeStyle = "#b3e5fc"; 
            ctx.lineCap = 'round';
            ctx.stroke();

            // å€åŸŸæ–‡å­—
            ctx.font = "bold 30px Microsoft JhengHei";
            ctx.fillStyle = "#81d4fa";
            ctx.fillText("é»ƒæµ¦æ±Ÿ", width/2 + 150, height/2);
            ctx.font = "bold 40px Microsoft JhengHei";
            ctx.fillStyle = "#e0e0e0";
            ctx.fillText("æµ¦è¥¿ (Puxi)", 50, 100);
            ctx.fillText("æµ¦æ± (Pudong)", width - 250, 150);

            // å®šç¾©åº§æ¨™ (åŒ…å« labelAlign å±¬æ€§)
            const hotel = {x: 720, y: 300, label: "å¦‚å®¶ç²¾é¸é…’åº—", icon: "ğŸ¨", labelAlign: "top"};
            const airport = {x: 750, y: 900, label: "æµ¦æ±æ©Ÿå ´ PVG", icon: "âœˆï¸"};
            const orientalPearl = {x: 580, y: 480, label: "æ±æ–¹æ˜ç ", icon: "ğŸ—¼", labelAlign: "right"};
            const trio = {x: 700, y: 600, label: "é™¸å®¶å˜´ä¸‰ä»¶å¥—", icon: "ğŸ™ï¸", labelAlign: "bottom"};

            const yuyuan = {x: 250, y: 750, label: "åŸéšå»Ÿ/è±«åœ’", icon: "ğŸ®", labelAlign: "bottom"};
            const russia = {x: 350, y: 280, label: "ä¿„ç¾…æ–¯é¤¨(è™¹å£)", icon: "ğŸ°", labelAlign: "top"};
            const nanjingRd = {x: 200, y: 480, label: "å—äº¬æ­¥è¡Œè¡—", icon: "ğŸ›ï¸", labelAlign: "left"};
            const bund = {x: 400, y: 600, label: "å¤–ç˜/è¬åœ‹å»ºç¯‰", icon: "ğŸ›ï¸", labelAlign: "top"};
            
            const xujiahui = {x: 160, y: 950, label: "å¾å®¶åŒ¯", icon: "ğŸ”®", labelAlign: "bottom"};
            const wukang = {x: 140, y: 750, label: "æ­¦åº·è·¯", icon: "ğŸ‚", labelAlign: "left"};
            const jingan = {x: 180, y: 500, label: "éœå®‰å¯º", icon: "ğŸ¯", labelAlign: "left"};
            const zhangyuan = {x: 280, y: 420, label: "å¼µåœ’", icon: "ğŸ§±", labelAlign: "top"};
            const lv = {x: 360, y: 320, label: "LVè·¯æ˜“è™Ÿ", icon: "ğŸ‘œ", labelAlign: "right"}; 
            const thousandTrees = {x: 180, y: 220, label: "å¤©å®‰åƒæ¨¹", icon: "ğŸŒ³", labelAlign: "left"};
            const circus = {x: 420, y: 120, label: "é¦¬æˆ²åŸ", icon: "ğŸª", labelAlign: "right"};

            // ç¹ªè£½ Day 2
            if (mapState.day2) {
                // 1. Hotel -> Yuyuan (Light)
                drawPath(ctx, hotel, yuyuan, "#ffab91", "1", "", 0.2);
                // 2. Yuyuan -> Russia (Dark)
                drawPath(ctx, yuyuan, russia, "#d84315", "2", "", 0.5);
                // 3. Russia -> Nanjing Rd (Light)
                drawPath(ctx, russia, nanjingRd, "#ffab91", "3");
                // 4. Nanjing Rd -> Bund (Dark)
                drawPath(ctx, nanjingRd, bund, "#d84315", "4");
                // 5. Bund -> Oriental Pearl (Light)
                drawPath(ctx, bund, orientalPearl, "#ffab91", "5", "éæ±Ÿ");
                // 6. Oriental Pearl -> Trio (Dark)
                drawPath(ctx, orientalPearl, trio, "#d84315", "6");
                // 7. Trio -> Hotel (Light)
                drawPath(ctx, trio, hotel, "#ffab91", "7");

                drawLocation(ctx, yuyuan, "#fff", "#ff5722");
                drawLocation(ctx, russia, "#fff", "#ff5722");
                drawLocation(ctx, nanjingRd, "#fff", "#ff5722");
                drawLocation(ctx, bund, "#fff", "#ff5722");
                drawLocation(ctx, orientalPearl, "#fff", "#ff5722");
                drawLocation(ctx, trio, "#fff", "#ff5722");
            }

            // ç¹ªè£½ Day 3
            if (mapState.day3) {
                // 1. Hotel -> Xujiahui (Light)
                drawPath(ctx, hotel, xujiahui, "#ce93d8", "1");
                // 2. Xujiahui -> Wukang (Dark)
                drawPath(ctx, xujiahui, wukang, "#7b1fa2", "2");
                // 3. Wukang -> Jingan (Light)
                drawPath(ctx, wukang, jingan, "#ce93d8", "3");
                // 4. Jingan -> Zhangyuan (Dark)
                drawPath(ctx, jingan, zhangyuan, "#7b1fa2", "4");
                // 5. Zhangyuan -> LV (Light)
                drawPath(ctx, zhangyuan, lv, "#ce93d8", "5", "", 0.5); 
                // 6. LV -> Thousand Trees (Dark)
                drawPath(ctx, lv, thousandTrees, "#7b1fa2", "6");
                // 7. Thousand Trees -> Circus (Light)
                drawPath(ctx, thousandTrees, circus, "#ce93d8", "7");
                // 8. Circus -> Hotel (Dark)
                drawPath(ctx, circus, hotel, "#7b1fa2", "8");

                drawLocation(ctx, xujiahui, "#fff", "#9c27b0");
                drawLocation(ctx, wukang, "#fff", "#9c27b0");
                drawLocation(ctx, jingan, "#fff", "#9c27b0");
                drawLocation(ctx, zhangyuan, "#fff", "#9c27b0");
                drawLocation(ctx, lv, "#fff", "#9c27b0"); 
                drawLocation(ctx, thousandTrees, "#fff", "#9c27b0");
                drawLocation(ctx, circus, "#fff", "#9c27b0");
            }

            // å…¬å…±åœ°é»
            drawLocation(ctx, hotel, "#fff", "#333");
            drawLocation(ctx, airport, "#e3f2fd", "#0277bd");

            // åœ–ä¾‹
            drawLegend(ctx, width - 240, 20);
        }

        function drawPath(ctx, start, end, color, stepNum, text = "", tValue = 0.5) {
            ctx.beginPath();
            ctx.setLineDash([10, 10]);
            ctx.moveTo(start.x, start.y);
            
            const cpX = (start.x + end.x) / 2;
            const cpY = (start.y + end.y) / 2;
            ctx.quadraticCurveTo(cpX, cpY, end.x, end.y);
            
            ctx.lineWidth = 3;
            ctx.strokeStyle = color;
            ctx.stroke();
            ctx.setLineDash([]); 

            // Calculate arrow position
            const targetR = 40; 
            const angle = Math.atan2(end.y - cpY, end.x - cpX);
            const arrowTipX = end.x - targetR * Math.cos(angle);
            const arrowTipY = end.y - targetR * Math.sin(angle);

            // Draw Arrow Head
            ctx.beginPath();
            ctx.moveTo(arrowTipX, arrowTipY);
            ctx.lineTo(arrowTipX - 10 * Math.cos(angle - Math.PI/6), arrowTipY - 10 * Math.sin(angle - Math.PI/6));
            ctx.lineTo(arrowTipX - 10 * Math.cos(angle + Math.PI/6), arrowTipY - 10 * Math.sin(angle + Math.PI/6));
            ctx.closePath();
            ctx.fillStyle = color;
            ctx.fill();

            // Step Number Bubble
            const t = tValue;
            const midX = (1-t)*(1-t)*start.x + 2*(1-t)*t*cpX + t*t*end.x;
            const midY = (1-t)*(1-t)*start.y + 2*(1-t)*t*cpY + t*t*end.y;

            ctx.beginPath();
            ctx.arc(midX, midY, 12, 0, 2 * Math.PI);
            ctx.fillStyle = color;
            ctx.fill();
            
            ctx.fillStyle = "white";
            ctx.font = "bold 14px Arial";
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillText(stepNum, midX, midY);

            if (text) {
                ctx.fillStyle = color;
                ctx.font = "bold 14px Microsoft JhengHei";
                ctx.fillText(text, midX + 25, midY);
            }
        }

        function drawLocation(ctx, loc, bgColor, borderColor) {
            const r = 35;
            
            // é™°å½±
            ctx.beginPath();
            ctx.arc(loc.x + 3, loc.y + 3, r, 0, 2 * Math.PI);
            ctx.fillStyle = "rgba(0,0,0,0.15)";
            ctx.fill();

            // åœ“æœ¬é«”
            ctx.beginPath();
            ctx.arc(loc.x, loc.y, r, 0, 2 * Math.PI);
            ctx.fillStyle = bgColor;
            ctx.fill();
            ctx.lineWidth = 3;
            ctx.strokeStyle = borderColor;
            ctx.stroke();

            // Emoji
            ctx.font = "30px Arial";
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillStyle = "#000";
            ctx.fillText(loc.icon, loc.x, loc.y + 2);

            // æ¨™ç±¤èƒŒæ™¯èˆ‡æ–‡å­—è¨ˆç®—
            ctx.font = "bold 16px Microsoft JhengHei";
            const textWidth = ctx.measureText(loc.label).width;
            const pad = 10;
            const boxH = 24;
            
            let tx, ty, bx, by;

            // æ ¹æ“š align å±¬æ€§æ±ºå®šä½ç½®
            const align = loc.labelAlign || 'bottom'; 

            if (align === 'top') {
                bx = loc.x - textWidth/2 - pad/2;
                by = loc.y - r - boxH - 5;
                tx = loc.x;
                ty = loc.y - r - 18;
            } else if (align === 'left') {
                bx = loc.x - r - textWidth - pad - 5;
                by = loc.y - boxH/2;
                tx = loc.x - r - textWidth/2 - 10;
                ty = loc.y;
            } else if (align === 'right') {
                bx = loc.x + r + 5;
                by = loc.y - boxH/2;
                tx = loc.x + r + textWidth/2 + 10;
                ty = loc.y;
            } else { 
                // bottom
                bx = loc.x - textWidth/2 - pad/2;
                by = loc.y + r + 5;
                tx = loc.x;
                ty = loc.y + r + 18;
            }

            ctx.fillStyle = "rgba(255, 255, 255, 0.95)";
            ctx.fillRect(bx, by, textWidth + pad, boxH);
            ctx.strokeRect(bx, by, textWidth + pad, boxH);
            
            ctx.fillStyle = "#333";
            ctx.textAlign = "center"; 
            ctx.textBaseline = "middle";
            
            if (align === 'left') ctx.fillText(loc.label, bx + textWidth/2 + pad/2, by + boxH/2);
            else if (align === 'right') ctx.fillText(loc.label, bx + textWidth/2 + pad/2, by + boxH/2);
            else ctx.fillText(loc.label, tx, ty);
        }

        function drawLegend(ctx, x, y) {
            ctx.fillStyle = "rgba(255,255,255,0.9)";
            ctx.fillRect(x, y, 220, 100);
            ctx.strokeStyle = "#999";
            ctx.lineWidth = 1;
            ctx.strokeRect(x, y, 220, 100);

            ctx.font = "bold 16px Microsoft JhengHei";
            ctx.fillStyle = "#333";
            ctx.textAlign = "left";
            ctx.fillText("è¡Œç¨‹ (Legend)", x + 15, y + 25);

            ctx.beginPath();
            ctx.arc(x + 20, y + 50, 8, 0, 2*Math.PI);
            ctx.fillStyle = "#ff5722";
            ctx.fill();
            ctx.fillStyle = "#333";
            ctx.fillText("Day 2 (å¤–ç˜ç¶“å…¸)", x + 40, y + 55);

            ctx.beginPath();
            ctx.arc(x + 20, y + 80, 8, 0, 2*Math.PI);
            ctx.fillStyle = "#9c27b0";
            ctx.fill();
            ctx.fillStyle = "#333";
            ctx.fillText("Day 3 (æ–‡è—é›œæŠ€)", x + 40, y + 85);
        }
    </script>
</body>
</html>